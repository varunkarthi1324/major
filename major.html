<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Human Verification Form</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <style>
      body {
        background: #f8f9fa;
      }
      .form-container {
        max-width: 420px;
        margin: 40px auto;
        padding: 30px 25px;
        background: #fff;
        border-radius: 12px;
        box-shadow: 0 0 18px #bbb;
      }
      .error-msg {
        color: #dc3545;
        font-size: 0.95rem;
        margin-top: 2px;
        margin-bottom: 8px;
        display: none;
      }
      .form-title {
        font-weight: bold;
        font-size: 1.5rem;
        margin-bottom: 18px;
        text-align: center;
        color: #0d6efd;
      }
      .password-toggle {
        cursor: pointer;
        position: absolute;
        right: 12px;
        top: 50%;
        transform: translateY(-50%);
        color: #888;
        font-size: 1.2rem;
        z-index: 2;
        background: none;
        border: none;
      }
      .position-relative {
        position: relative;
      }
      .strength-meter {
        height: 7px;
        border-radius: 5px;
        margin-top: 4px;
        margin-bottom: 8px;
        background: #e9ecef;
        overflow: hidden;
      }
      .strength-bar {
        height: 100%;
        border-radius: 5px;
        transition: width 0.3s;
      }
      .strength-weak {
        width: 33%;
        background: #dc3545;
      }
      .strength-medium {
        width: 66%;
        background: #ffc107;
      }
      .strength-strong {
        width: 100%;
        background: #198754;
      }
      .captcha-box {
        background: #f1f3f4;
        border-radius: 6px;
        padding: 10px 12px;
        margin-bottom: 8px;
        font-size: 1.1rem;
        display: flex;
        align-items: center;
        gap: 10px;
      }
      @keyframes fadein {
        from {
          opacity: 0;
          transform: scale(0.95);
        }
        to {
          opacity: 1;
          transform: scale(1);
        }
      }
      .success-animate {
        animation: fadein 0.5s;
      }
    </style>
  </head>
  <body>
    <div class="form-container">
      <div class="form-title">Human Verification Form</div>
      <form id="registerForm" novalidate autocomplete="off">
        <div class="mb-3">
          <label for="fullName" class="form-label">Full Name*</label>
          <input
            type="text"
            class="form-control"
            id="fullName"
            name="fullName"
            required
          />
          <div class="error-msg" id="nameError"></div>
        </div>
        <div class="mb-3">
          <label for="email" class="form-label">Email ID*</label>
          <input
            type="email"
            class="form-control"
            id="email"
            name="email"
            required
          />
          <div class="error-msg" id="emailError"></div>
        </div>
        <div class="mb-3">
          <label for="phone" class="form-label">Phone Number*</label>
          <input
            type="tel"
            class="form-control"
            id="phone"
            name="phone"
            required
          />
          <div class="error-msg" id="phoneError"></div>
        </div>
        <div class="mb-3 position-relative">
          <label for="password" class="form-label">Password*</label>
          <input
            type="password"
            class="form-control"
            id="password"
            name="password"
            required
          />
          <button
            type="button"
            class="password-toggle"
            tabindex="-1"
            onclick="togglePassword('password', this)"
          >
            üëÅÔ∏è
          </button>
          <div class="strength-meter" id="strengthMeter">
            <div class="strength-bar" id="strengthBar"></div>
          </div>
          <div class="error-msg" id="passwordError"></div>
        </div>
        <div class="mb-3 position-relative">
          <label for="confirmPassword" class="form-label"
            >Confirm Password*</label
          >
          <input
            type="password"
            class="form-control"
            id="confirmPassword"
            name="confirmPassword"
            required
          />
          <button
            type="button"
            class="password-toggle"
            tabindex="-1"
            onclick="togglePassword('confirmPassword', this)"
          >
            üëÅÔ∏è
          </button>
          <div class="error-msg" id="confirmPasswordError"></div>
        </div>
        <div class="mb-3">
          <div class="captcha-box">
            <span id="captchaQuestion"></span>
            <input
              type="text"
              class="form-control"
              id="captchaAnswer"
              style="width: 80px"
              placeholder="?"
              required
            />
          </div>
          <div class="error-msg" id="captchaError"></div>
        </div>
        <button type="submit" class="btn btn-primary w-100">Register</button>
      </form>
      <div
        id="successMsg"
        class="alert alert-success mt-3"
        style="display: none; text-align: center; font-size: 1.1rem"
      >
        <span style="font-size: 1.6rem">‚úîÔ∏è</span> Registration successful!
      </div>
    </div>
    <script>
      // Get form and input elements
      const form = document.getElementById("registerForm");
      const nameInput = document.getElementById("fullName");
      const emailInput = document.getElementById("email");
      const phoneInput = document.getElementById("phone");
      const passwordInput = document.getElementById("password");
      const confirmPasswordInput = document.getElementById("confirmPassword");
      const captchaQuestion = document.getElementById("captchaQuestion");
      const captchaAnswer = document.getElementById("captchaAnswer");

      // Get error message elements
      const nameError = document.getElementById("nameError");
      const emailError = document.getElementById("emailError");
      const phoneError = document.getElementById("phoneError");
      const passwordError = document.getElementById("passwordError");
      const confirmPasswordError = document.getElementById(
        "confirmPasswordError"
      );
      const captchaError = document.getElementById("captchaError");
      const successMsg = document.getElementById("successMsg");

      // Password strength meter
      const strengthMeter = document.getElementById("strengthMeter");
      const strengthBar = document.getElementById("strengthBar");

      // Captcha variables
      let captchaResult = 0;

      // Utility function to show error
      function showError(element, message) {
        element.innerText = message;
        element.style.display = "block";
      }
      // Utility function to hide error
      function hideError(element) {
        element.innerText = "";
        element.style.display = "none";
      }

      // Show/Hide password toggle
      function togglePassword(fieldId, btn) {
        const input = document.getElementById(fieldId);
        if (input.type === "password") {
          input.type = "text";
          btn.innerText = "üôà";
        } else {
          input.type = "password";
          btn.innerText = "üëÅÔ∏è";
        }
      }

      // Password strength checker
      function checkPasswordStrength(password) {
        let strength = 0;
        if (password.length >= 8) strength++;
        if (/[A-Z]/.test(password)) strength++;
        if (/[0-9]/.test(password)) strength++;
        if (/[^A-Za-z0-9]/.test(password)) strength++;
        if (strength <= 1) {
          strengthBar.className = "strength-bar strength-weak";
        } else if (strength === 2 || strength === 3) {
          strengthBar.className = "strength-bar strength-medium";
        } else {
          strengthBar.className = "strength-bar strength-strong";
        }
        strengthBar.style.width = password.length === 0 ? "0" : "";
      }

      // Validate Full Name
      function validateName() {
        const name = nameInput.value.trim();
        if (name.length < 5) {
          showError(nameError, "Name must be at least 5 characters.");
          return false;
        }
        hideError(nameError);
        return true;
      }

      // Validate Email
      function validateEmail() {
        const email = emailInput.value.trim();
        if (
          !email.includes("@") ||
          email.startsWith("@") ||
          email.endsWith("@")
        ) {
          showError(emailError, "Enter a valid email address.");
          return false;
        }
        hideError(emailError);
        return true;
      }

      // Validate Phone Number
      function validatePhone() {
        const phone = phoneInput.value.trim();
        if (phone === "123456789" || phone === "1234567890") {
          showError(
            phoneError,
            "Phone number cannot be 123456789 or 1234567890."
          );
          return false;
        }
        if (!/^\d{10}$/.test(phone)) {
          showError(phoneError, "Phone number must be exactly 10 digits.");
          return false;
        }
        hideError(phoneError);
        return true;
      }

      // Validate Password
      function validatePassword() {
        const password = passwordInput.value;
        const name = nameInput.value.trim().toLowerCase();
        if (password.length < 8) {
          showError(passwordError, "Password must be at least 8 characters.");
          return false;
        }
        if (password.toLowerCase() === "password") {
          showError(passwordError, "Password cannot be 'password'.");
          return false;
        }
        if (password.toLowerCase() === name && name.length > 0) {
          showError(passwordError, "Password cannot be your name.");
          return false;
        }
        hideError(passwordError);
        return true;
      }

      // Validate Confirm Password
      function validateConfirmPassword() {
        if (confirmPasswordInput.value !== passwordInput.value) {
          showError(confirmPasswordError, "Passwords do not match.");
          return false;
        }
        hideError(confirmPasswordError);
        return true;
      }

      // Generate a simple math captcha
      function generateCaptcha() {
        const a = Math.floor(Math.random() * 10) + 1;
        const b = Math.floor(Math.random() * 10) + 1;
        captchaResult = a + b;
        captchaQuestion.innerText = `What is ${a} + ${b}?`;
        captchaAnswer.value = "";
      }

      // Validate captcha
      function validateCaptcha() {
        if (parseInt(captchaAnswer.value, 10) !== captchaResult) {
          showError(captchaError, "Incorrect answer to the math question.");
          return false;
        }
        hideError(captchaError);
        return true;
      }

      // Validate all fields
      function validateForm() {
        let valid = true;
        if (!validateName()) valid = false;
        if (!validateEmail()) valid = false;
        if (!validatePhone()) valid = false;
        if (!validatePassword()) valid = false;
        if (!validateConfirmPassword()) valid = false;
        if (!validateCaptcha()) valid = false;
        return valid;
      }

      // Add event listeners for real-time validation
      nameInput.addEventListener("input", validateName);
      emailInput.addEventListener("input", validateEmail);
      phoneInput.addEventListener("input", validatePhone);
      passwordInput.addEventListener("input", function () {
        validatePassword();
        checkPasswordStrength(passwordInput.value);
      });
      confirmPasswordInput.addEventListener("input", validateConfirmPassword);
      captchaAnswer.addEventListener("input", validateCaptcha);

      // On form submit
      form.addEventListener("submit", function (e) {
        e.preventDefault();
        successMsg.style.display = "none";
        if (validateForm()) {
          form.reset();
          checkPasswordStrength(""); // Reset strength meter
          generateCaptcha(); // New captcha for next time
          successMsg.classList.add("success-animate");
          successMsg.style.display = "block";
          setTimeout(() => {
            successMsg.style.display = "none";
            successMsg.classList.remove("success-animate");
          }, 2500);
        }
      });

      // Initialize
      generateCaptcha();
      checkPasswordStrength("");
    </script>
  </body>
</html>
